# 前言-人工智能简介

## 1. 人工智能主要分支

### 1.1 主要分支介绍

通讯、感知与行动是现代人工智能的三个关键能力，在这里我们将根据这些能力/应用对这三个技术领域进行介绍:

- **计算机视觉(CV)**
- **自然语言处理(NLP)**
  - 在NLP领域中，将覆盖文本挖掘/分类、机器翻译和语音识别。
- **机器人**

### 1.2 分支一：计算机视觉

**计算机视觉(CV)是指机器感知环境的能力。**这一技术类别中的经典任务有图像形成、图像处理、图像提取和图像的三维推理。**物体检测和人脸识别是其比较成功的研究领域。**

**当前阶段:**

> 计算机视觉现已有很多应用，这表明了这类技术的成就，也让我们将其归入到应用阶段。随着深度学习的发展，机器甚至能在特定的案例中实现超越人类的表现。但是，这项技术离社会影响阶段还有一定距离，那要等到机器能在所有场景中都达到人类的同等水平才行(感知其环境的所有相关方面)。

### 1.3 分支二：语音识别

**语音识别是指识别语音(说出的语言)并将其转换成对应文本的技术。**相反的任务(文本转语音/TTS)也是这一领域内一个类似的研究主题。

**当前阶段:**

> 语音识别已经处于应用阶段很长时间了。最近几年，随着大数据和深度学习技术的发展，语音识别进展颇丰，现在已经非常接近社会影响阶段了。
> 语音识别领域仍然面临着**声纹识别**和「**鸡尾酒会效应**」等一些特殊情况的难题。
> **现代语音识别系统严重依赖于云，在离线时可能就无法取得理想的工作效果。**

### 1.4 分支三：文本挖掘/分类

**这里的文本挖掘主要是指文本分类，该技术可用于理解、组织和分类结构化或非结构化文本文档。**其涵盖的主要任务有句法分析、情绪分析和垃圾信息检测。

**当前阶段:**

> 我们将这项技术归类到应用阶段，因为现在有很多应用都已经集成了基于文本挖掘的情绪分析或垃圾信息检测技术。文本挖掘技术也在智能投顾的开发中有所应用，并且提升了用户体验。
> **文本挖掘和分类领域的一个瓶颈出现在歧义和有偏差的数据上。**

### 1.5 分支四：机器翻译

**机器翻译(MT)是利用机器的力量自动将一种自然语言(源语言)的文本翻译成另一种语言(目标语言)。**

**当前阶段:**

> 机器翻译是一个见证了大量发展历程的应用领域。该领域最近由于神经机器翻译而取得了非常显著的进展，但仍然没有全面达到专业译者的水平﹔但是，我们相信在大数据、云计算和深度学习技术的帮助下，机器翻译很快就将进入社会影响阶段。
> 在某些情况下，**俚语和行话等内容的翻译会比较困难**(受限词表问题)。
> **专业领域的机器翻译(比如医疗领域)表现通常不好。**

### 1.6 分支五：机器人

**机器人学(Robotics)研究的是机器人的设计、制造、运作和应用，以及控制它们的计算机系统、传感反馈和信息处理。**

机器人可以分成两大类：**固定机器人**和**移动机器人**。

- 固定机器人通常被用于工业生产(比如用于装配线)。
- 常见的移动机器人应用有货运机器人、空中机器人和自动载具。
- 机器人需要不同部件和系统的协作才能实现最优的作业。其中在硬件上包含传感器、反应器和控制器;另外还有能够实现感知能力的软件，比如定位、地图测绘和目标识别。

**当前阶段:**

> 自上世纪「Robot」一词诞生以来，人们已经为工业制造业设计了很多机器人。工业机器人是增长最快的应用领域，它们在20世纪80年代将这一领域带入了应用阶段。在安川电机、Fanuc、ABB、库卡等公司的努力下，我们认为进入21世纪之后，机器人领域就已经进入了社会影响阶段，此时各种工业机器人已经主宰了装配生产线。此外，软体机器人在很多领域也有广泛的应用，比如在医疗行业协助手术或在金融行业自动执行承销过程。



## 2. 机器学习流程

### 2.1 什么是机器学习

机器学习是从**数据中自动分析获得模型**，并利用**模型**对未知数据进行预测。

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/b08f38ccaaf2262f7853bed3e03e49c7.png)



### 2.2 机器学习流程

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/3321002138817b3cab107f7cdc86c9e7.png)

1. 获取数据
2. 数据基本处理
3. 特征工程
4. 机器学习(模型训练)
5. 模型评估
   - 结果达到要求，上线服务
   - 没有达到要求，重新上面步骤



#### 2.2.1 获取数据集

**数据简介:**

- 一行数据称为一个**样本**
- 一列数据称为一个**特征**

- 有些数据有**目标值(标签值)**，有些数据没有目标值

**数据类型构成:**

- 数据类型一：特征值+目标值（目标值是连续的和离散的）
- 数据类型二：只有特征值，没有目标值

**数据分割:**

- 机器学习一般的数据集会划分为两个部分︰
  - 训练数据:用于训练，构建模型
  - 测试数据:在模型检验时使用，用于评估模型是否有效。
- 划分比例:
  - 训练集:70% 80% 75%
  - 测试集:30% 20% 25%



#### 2.2.2 数据基本处理

即对数据进行缺失值、去除异常值等处理

#### 2.2.3 特征工程



##### 2.2.3.1 什么是特征工程

特征工程是使用**专业背景知识和技巧处理数据，使得特征能在机器学习算法上发挥更好的作用的过程。**

- 意义: 会直接影响机器学习的效果



##### 2.2.3.2 特征工程内容

**特征工程包含**

- 特征提取
- 特征预处理
- 特征降维

**特征提取**

- 将任意数据(如文本或图像)转换为可用于机器学习的数字特征

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/4f3b9972fde9119501897a897017ae3a.png)

**特征预处理**

- 通过一些转换函数将特征数据转换成**更加适合算法模型**的特征数据过程

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/8cdeae49690c83ac785eea19da88856f.png)

**特征降维**

- 指在某些限定条件下，降低随机变量(特征)个数，得到一组“不相关”主变量的过程

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/f384b98b8d8920ed65ed42938e6a24a8.png)



#### 2.2.4 机器学习

选择合适的算法对模型进行训练



#### 2.2.5 模型评估

对训练好的模型进行评估



## 3. 机器学习算法分类

根据**数据集组成不同**，可以把机器学习算法分为:

- 监督学习
- 无监督学习
- 半监督学习
- 强化学习

### 3.1 监督学习

定义:

- 输入数据是由输入特征值和目标值所组成。
  - 函数的输出可以是一个连续的值(称为回归)
  - 或是输出是有限个离散值（称作分类)。

#### 3.1.1 回归问题

例如︰预测房价，根据样本集拟合出一条连续曲线。

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/3e173afba3af83399f0c5a3d6cf2134e.png)

#### 3.1.2 分类问题

例如︰根据肿瘤特征判断良性还是恶性，得到的是结果是"良性"或者“恶性”，是离散的。

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/f9309a6146de44df219425ec1e9e1a54.png)



### 3.2 无监督学习

定义:

- 输入数据是由输入特征值组成，没有目标值
  - 输入数据没有被标记，也没有确定的结果。样本数据类别未知;
  - 需要根据样本间的相似性对样本集进行类别划分。

#### 3.2.1 有监督、无监督算法对比

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/ca4a4f396e19c2da2b9571745b0b30bc.png)



### 3.3 半监督学习

定义:

- 训练集同时包含有标记样本数据和未标记样本数据。

**监督学习训练方式**

- 标注全部数据，然后进行训练

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/326c9a7e56986d5933bbeec2cd4b7e82.png)

**半监督学习训练方式**

- 只标注少量数据，然后用训练出来的模型训练剩下的数据

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/6c086da7f24e3938dda47ca9bf621255.png)



### 3.4 强化学习

定义:

- 实质是make decisions 问题，即**自动进行决策**，并且可以做连续决策。

举例:

- 小孩想要走路，但在这之前，他需要先站起来，站起来之后还要保持平衡，接下来还要先迈出一条腿，是左腿还是右腿，迈出一步后还要迈出下一步。
- 小孩就是`agent`，他试图通过采取**行动**(即行走）来操纵**环境**（行走的表面)，并且从**一个状态转变到另一个状态**（即他走的每一步)，当他完成任务的子任务(即走了几步)时，孩子得到**奖励**（给巧克力吃)，并且当他不能走路时，就不会给巧克力。
- 主要包含五个元素:agent, action, reward, environment, observation;

强化学习的**目标**就是**获得最多的累计奖励**。

|          | 监督学习                               | 强化学习                                                     |
| -------- | -------------------------------------- | ------------------------------------------------------------ |
| 反馈映射 | 输出的是之间的关系，可以告诉算法什么   | 输出的是给机器的反馈reward function，即用来判断这个行为是好是坏。 |
| 反馈时间 | 做了比较坏的选择会**立刻反馈给算法**。 | 结果**反馈有延时**，有时候可能需要走了很多步以后才知道以前的某一步的选择是好还是坏。 |
| 输入特征 | 输入是**独立同分布的**。               | 面对的输入总是在变化，每当算法做出一个行为，它影响下一次决策的输入。 |



### 3.5 四种方式总结

|            | 输入                   | 输出       | 目的               | 案例               |
| ---------- | ---------------------- | ---------- | ------------------ | ------------------ |
| 监督学习   | 有标签                 | 有反馈     | 预测结果           | 猫狗分类、房价预测 |
| 无监督学习 | 无标签                 | 无反馈     | 发现潜在结构       | 物以类聚、人以群分 |
| 半监督学习 | 部分有标签、部分无标签 | 有反馈     | 降低数据标记的难度 |                    |
| 强化学习   | 决策流程及激励系统     | 一系列行动 | 长期利益最大化     | 学下棋             |



## 4. 模型评估

模型评估是模型开发过程不可或缺的一部分。它有助于发现表达数据的最佳模型和所选模型将来工作的性能如何。

按照**数据集的目标值**不同，可以把模型评估分为**分类模型评估**和**回归模型评估**。

### 4.1 分类模型评估

准确率

- 预测正确的数占样本总数的比例。

其他评价指标

- 精确率、召回率、F1-score、AUC指标等

### 4.2 回归模型评估

均方根误差(RMSE)

- RMSE是一个衡量回归模型误差率的常用公式。不过，它仅能比较误差是相同单位的模型。

$$
RMSE=\sqrt{\frac{\sum\limits_{i=1}^n(p_i-a_i)^2}{n}}
\\a=actual~target
\\ p=predicted~target
$$

举例

```
假设上面的房价预测,只有五个样本，对应的
真实值为:100,120,125,230,400
预测值为:105,119,120,230,410
```

那么使用均方根误差求解得:
$$
RMSE=\sqrt{\frac{[(100-105)^2+(120-119)^2+5^2+0^2+10^2]}{5}}=5.495
$$
**其他评价指标:相对平方误差（Relative $quared Error，RSE)、平均绝对误差（Mean AbsoluteError,MAE)、相对绝对误差(Relative Absolute Error，RAE)**



### 4.3 拟合

模型评估用于评价训练好的的模型的表现效果，其表现效果大致可以分为两类:过拟合、欠拟合。在训练过程中，你可能会遇到如下问题:

训练数据训练的很好啊，误差也不大，为什么在测试集上面有问题呢?当算法在某个数据集当中出现这种情况，可能就出现了**拟合问题**。

#### 4.3.1 欠拟合

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/1b4fee0a7fb83b6cc5dd177641bc5566.png)

因为机器学习到的天鹅特征太少了，导致区分标准太粗糙，不能准确识别出天鹅。
**欠拟合(under-fitting)︰**

- 模型学习的太过粗糙，连训练集中的样本数据特征关系都没有学出来。



#### 4.3.2 过拟合

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/8b77d0dd9589f7cefc046c7519def7ad.png)

机器已经基本能区别天鹅和其他动物了。然后，很不巧已有的天鹅图片全是白天鹅的，于是机器经过学习后，会认为天鹅的羽毛都是白的，以后看到羽毛是黑的天鹅就会认为那不是天鹅。

**过拟合(over-ftting)︰**

- 所建的机器学习模型或者是深度学习模型在训练样本中**表现得过于优越**，导致在测试数据集中表现不佳。



## 5. 深度学习

### 5.1 深度学习简介

深度学习(Deep Learning)

- (也称为深度结构学习【Deep Structured Learning】、层次学习
  【[Hierarchical Learning】或者是深度机器学习【Deep Machine Learning】 ）
- 是一类算法集合，是机器学的一个分支。
- 深度学习方法近年来，在会话识别、图像识别和对象侦测等领域表现出了惊人的准确性。

[深度学习演示](http://playground.tensorflow.org/)

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/1d42523917f67914f5b2c701a00b7476.png)

### 5.2 深度学习各层负责的内容

1层∶负责识别颜色及简单纹理

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/eac6326573987e35d82c2c353fabec96.png)

2层:一些神经元可以识别更加细化的纹理，布纹，刻纹，叶纹等

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/e3d0b57b424ba96d207cc42106b75467.png)

3层:一些神经元负责感受黑夜里的黄色烛光，高光，萤火，鸡蛋黄色等。

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/32924fa8cbb340090f9c4296d2c9f12d.png)

4层:一些神经元识别萌狗的脸，宠物形貌，圆柱体事物，七星瓢虫等的存在。

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/4638d2e8a5d070e4f14f518e00abb3b5.png)

5层:一些神经元负责识别花，黑眼圈动物，鸟，键盘，原型屋顶等。

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/1c3e0289a672e66448c380d6f64f43c3.png)



# 第一部分-机器学习

## 1. 机器学习环境配置

### 1.1 安装库

整个机器学习基础阶段会用到Matplotlib、Numpy、Pandas等库，为了统一版本号在环境中使用，将所有的库及其版本放到了文件requirements.txt当中，然后统一安装

**新建一个用于人工智能环境的虚拟环境**

```
mkvirtualenv ai
```

```
matplotlib==2.2.2
numpy==1.14.3
pandas==0.20.3
tables==3.4.2
jupyter==1.0.0
```

使用pip命令安装

```
pip3 install -r requirements.txt
```



### 1.2 jupyter notebook使用

Jupyter项目是一个非盈利的开源项目，源于2014年的ipython项目，因为它逐渐发展为支持跨所有编程语言的交互式数据科学和科学计算

- Jupyter Notebook，原名IPython Notbook，是IPython的加强网页版，一个开源Web应用程序
- 名字源自Julia、Python和R（数据科学的三种开源语言)
- 是一款程序员和科学工作者的编程/文档/笔记/展示软件
- `.ipynb`文件格式是用于计算型叙述的JSON文档格式的正式规范



## 2. Matplotlib

### 2.1 简介

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/68edd9a3dd4fad00b268bd95106d7829.png)

- 是专门用于开发2D图表(包括3D图表)
- 以渐进、交互式方式实现数据可视化

### 2.2 简单使用

1. 导入模块

```py
import matplotlib.pyplot as plt
import random
```

2. 创建数据

```py
x = range(60)
y_shanghai = [random.uniform(15,18) for i in x]
```

3. 创建画布

```py
plt.figure(figsize=(20,8),dpi=80)
# figsize:指定图的长宽
# dpi:图像清晰度
# 返回fig对象
```

4. 绘制折线图

```py
# 绘制折线图
plt.plot(x,y_shanghai)
```

5. 显示图像

```py
# 显示图像
plt.show()
```

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/27e3937b87fb67aff04ef5101ab5d562.png)

### 2.3 Matplotlib图像结构

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/1758df2629683516c0a02cd37f8e26f5.png)

### 2.4 添加x、y轴刻度

- `plt.xticks(x,**kwargs)`

  x:要显示的刻度值

- `plt.yticks(y,**kwargs)`

  y:要显示的刻度值

```py
plt.figure(figsize=(20, 8), dpi=100)
# figsize:指定图的长宽
# dpi:图像清晰度
# 返回fig对象

# 构造x轴刻度标签
x_ticks_label = ["11点{}分".format(i) for i in x]
# 构造y轴刻度标签
y_ticks = range(40)

# 绘制折线图
plt.plot(x, y_shanghai)

# 修改x,y轴坐标的刻度显示
plt.xticks(x[::5], x_ticks_label[::5])
plt.yticks(y_ticks[::5])
# 显示图像

plt.show()
```



### 2.5 解决中文显示问题

在Python脚本中动态设置matplotlibrc

```py
from pylab import mpl
# 设置中文字体
mpl.rcParams['font.sans-serif'] = ['SimHei']
```

有时候，字体更改后，会导致坐标轴中的部分字符无法正常显示，此时需要更改`axes.unicode_minus`参数:

```py
# 设置正常显示符号
mpl.rcParams["axes.unicode_minus"] = False
```

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/2cf32349ca3542f4ffe4d79ed132aef4.png)

### 2.6 其他基本操作

#### 2.6.1 添加网格显示

```py
plt.grid(True,linestyle='--',alpha=0.5)
```

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/305731b80a1257093a98736124907d1b.png)

#### 2.6.2 添加描述信息

添加x轴、y轴描述信息及标题

```py
plt.xlabel("时间")
plt.ylabel("温度")
plt.title("中午11点到12点之间的温度变化图示",fontsize=20)
```

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/3f2fa4f34b637ad33daa46dc19883bba.png)

#### 2.6.3 保存图片

```py
plt.savefig("test.png")
```

#### 2.6.4 绘制多条线段

```py
x = range(60)
y_shanghai = [random.uniform(15, 18) for i in x]
y_beijing = [random.uniform(1, 3) for i in x]
# 绘制折线图
plt.plot(x, y_shanghai)
plt.plot(x, y_beijing)
```

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/85b38558f1a0266dabb4f5b714c5bf6e.png)

#### 2.6.5 设置图形风格

| 颜色字符 | 风格字符      |
| -------- | ------------- |
| r 红色   | - 实线        |
| g 绿色   | -- 虚线       |
| b 蓝色   | -. 点划线     |
| w 白色   | : 点虚线      |
| c 青色   | ' '留空、空格 |
| m 洋红   |               |
| y 黄色   |               |
| k 黑色   |               |

#### 2.6.6 显示图例

```py
# 绘制折线图
plt.plot(x, y_shanghai)
plt.plot(x, y_beijing)
# 显示图例
plt.legend(["上海", "北京"],loc="best")
```

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/f6696c7096c62d43f6b6c9286357bab3.png)



### 2.7 多个坐标系显示--plt.subplots

如果我们想要将上海和北京的天气图显示在同一个图的不同坐标系当中，效果如下:

可以通过subplots函数实现(旧的版本中有subplot，使用起来不方便)，推荐subplots函数

- `matplotlib.pyplot.subplots(nrows=1, ncols=1,**fig_kw)`创建一个带有多个axes(坐标系/绘图区)的图

`plt.函数名()`相当于面向过程的画图方法，`axes.set_方法名()`相当于面向对象的画图方法。



## 3. numpy

### 3.1 numpy介绍

Numpy（Numerical Python）是一个开源的Python科学计算库，用于快速处理任意维度的数组。

Numpy支持常见的数组和矩阵操作。对于同样的数值计算任务，使用Numpy比直接使用Python要简洁的多。 

Numpy使用ndarray对象来处理多维数组，该对象是一个快速而灵活的大数据容器。



### 3.2 ndarray

#### 3.2.1 ndarray介绍

NumPy提供了一个N维数组类型ndarray，它描述了**相同类型**的“items”的集合。



#### 3.2.2 ndarray 的优势

ndarray比python原生的list要快得多，因此在数据处理方面ndarray比较擅长

##### 3.2.2.1 内存块风格

ndarray到底跟原生python列表有什么不同呢

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/80151732d121bedd796d87c8e378f01c.png)

从图中我们可以看出ndarray在存储数据的时候，数据与数据的地址都是连续的，这样就给使得批量操作数组元素时速度更快。

##### 3.2.2.2  ndarray支持并行化运算（向量化运算）

numpy内置了并行运算功能，当系统有多个核心时，做某种计算时，numpy会自动做并行计算

##### 3.2.2.3 效率远高于纯Python代码

Numpy底层使用C语言编写，内部解除了GIL（全局解释器锁），其对数组的操作速度不受Python解释器的限制，所以，其效率远高于纯 Python代码。



### 3.3 ndarray的使用

#### 3.3.1 属性

数组属性反映了数组本身固有的信息。

| 属性名字         | 属性解释                   |
| ---------------- | -------------------------- |
| ndarray.shape    | 数组维度的元组             |
| ndarray.ndim     | 数组维数                   |
| ndarray.size     | 数组中的元素数量           |
| ndarray.itemsize | 一个数组元素的长度（字节） |
| ndarray.dtype    | 数组元素的类型             |



#### 3.3.2 类型

```python
>>> type(score.dtype)
<type 'numpy.dtype'>
```

dtype是numpy.dtype类型，先看看对于数组来说都有哪些类型

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/94266e1731d4e5f6ccf9627bbe60d02d.png)

创建数组的时候指定类型

```python
>>> a = np.array([[1, 2, 3],[4, 5, 6]], dtype=np.float32)
>>> a.dtype
dtype('float32')
>>> arr = np.array(['python', 'tensorflow', 'scikit-learn', 'numpy'], dtype = np.string_)
>>> arr
array([b'python', b'tensorflow', b'scikit-learn', b'numpy'], dtype='|S12')
```

注意：若不指定，整数默认int64，小数默认float64



#### 3.3.3 生成数组

- np.ones(shape, dtype)
- np.ones_like(a, dtype)
- np.zeros(shape, dtype)
- np.zeros_like(a, dtype
