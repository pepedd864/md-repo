# 模拟电路

# 计算机组成原理

## 1.  二进制与编码

### 1.1 二进制相关概念

**二进制**

> 二进制是一种计数法，它使用两个数字0和来表示数值。在计算机中，数字是用二进制来表示的，因为电路只能表示电信号的有无，即0或1。因此，所有的计算机数据和指令都是用二进制编码的。

**bit位**

>计算机中的一位二进制表示单个数字1或0，1位二进制数字命名为位(bit)也称1比特

**byte字节**

> 1byte=8bit，即1byte代表8位数字。最早期的电脑为八位的，即以八位为单位处理数据。为了方便，将八位数字命名为1字节 (1byte)



### 1.2 32位系统和64位系统的区别

32位和64位都表示内存地址的大小。

32位的最大数为43亿左右，换算成GB大概是4GB，因此32位系统的最大内存为4GB。

64位的最大数为9.2*10^18，这个数字在现在看来是比较大的，因此解决了32位系统内存太小的问题。



### 1.3 二进制表示文字

最早计算机是美国人发明的，他们先用二进制表示了常见的英文字母和符号

> 例如: ASCII 美国信息交换标准码表
> 全称:美国信息交换标准代码
> 作用:用数字给英文字母及符号编号
> 内容: 7位代码，可存放128个不同的值

1981年 中国发布了汉字的二进制编码表

> GB2312编码:1981年5月1日发布的简体中文汉字编码国家标准。收录7445个图形字符，其中包括6763个汉字
>
> BIG5编码:台湾地区繁体中文标准字符集，共收录13053个中文字，1984年实施。
>
> GBK编码: 2000年3月17日发布，收录21003个汉字，包含国家标准GB13000-1中的全部中日韩汉字，和BIG5编码中的所有汉字

统一人类语言

> 通过码表，我们把计算机0011的二进制符号和人类语言的符号建立了映射关系。
>
> 1992诞生，随着计算机在亚洲兴起，需要解决每个国家码表不统一的问题，为了提高代码的互用性，而诞生的编码标准。UNICODE为16位数字，理论上有2的16次方也就是有超过100万个位置，可满足地球上所有语言的字符需求。



### 1.4 二进制表示图片

**黑白图**

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/4778fe3710fdcaea662b03bd4f38256d.png" style="zoom:67%;" />

> 上面是个6x6大小的显示屏，由36个白色LED组成，只有
> 黑和白两种颜色，我们可以用0表示黑，用1表示白。



**灰度图**

> led灯可以通过PWM等技术去调节亮度，这样就可以表示不同的亮度，从黑 (不亮) 到白色 (最亮)，
> 每个像素点通过一个0到255的8bit的数字 (1byte) 来表示，所以28x28像素的灰度图图片需要784个byte来表示

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/584132db4ebae1a652811ccbd4118add.png" style="zoom:67%;" />

**彩色图**

> 用0~255*255*255表示颜色数据
> 每一个像素点由RGB三种颜色组成。



### 1.5 二进制表示声音

**声音采样每一时刻的震动幅度**

> 采样:将声音信号按照一定的时间间隔进行采样，把每个时间点上声音信号的振幅转换成数字数
> 据。采样率越高，转换出的数字

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/cb1ff70d4992afeb1b6643ef05ca913f.png)



### 1.6 二进制表示视频

**视频=图片+声音**

>在数字视频中，视频帧被分解为数字像素，并将每个像素表示为二进制数。每个像素通常由三个分量表示: 红色、绿色和蓝色分量即RGB值。每个分量通常使用8位二进制数(即一个字节)表示，因此每个像素由24位二进制数(即三个字节)表示
>
>视频的每一帧都由一系列像素组成。如果视频的分辨率为1920x1080(高清1080p)，则每一顿将包含1920 x 1080 =2,073,600个像素。对于每个像素，计算机将RGB值编码为二进制数字，并将所有像素编码成一长串二进制数字序列。这个序列被存储在计算机的硬盘驱动器中，以便以后可以被读取和播放。



## 2. 逻辑门电路

### 2.1 布尔运算和逻辑运算

布尔运算和逻辑运算概念类似，布尔运算是数学界的说法，逻辑运算是计算机界的说法。

布尔运算是基于布尔代数的一种数学运算，它使用真和假值进行运算。布尔运算包括逻辑与、逻辑或和逻辑非。

逻辑运算是电路设计中的运算，它和布尔运算类似，但是用于在电路中进行运算。逻辑运算包括与、或和非。

布尔运算的基本运算符包括与(AND)、或(OR)、非(NOT)和异或(XOR)。布尔运算的结果只有真或假两种可能，通常用于程序中的判断语句和逻辑控制。



### 2.2 逻辑门

**用于实现逻辑 (布尔) 计算的电路**

> 逻辑门是一种电路元器件，它能够执行一种或多种逻辑运算。常见的逻辑门有: 与门 (AND gate) 、或门 (OR gate) 、非门 (NOT gate) 、异或门(XOR gate) 等
>
> 这些逻辑门通过接受一些输入信号，并根据逻辑运算规则产生一个输出信号。这些逻辑运算可以用来构建复杂的逻辑电路，实现各种各样的功能



#### 2.2.1 与门

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/998d917a4bcb429058e3c95f3da91576.png" style="zoom:50%;" />

>与门是计算机里面一种很特殊的门，它有两个输入，叫做A和B。如果A和B两个输入都是1，那么与门的输出就是1，否则输出就是0。与门的作用就像是一个开关，它能够根据两个输入的情况来决定是否让电流通过

**真值表和简化符号如下**

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/77ee32f5925a6f48de55a05b0db5cac7.png" style="zoom:50%;" />



#### 2.2.2 或门

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/0e3ca3fa4b2c654d3de26e4bc0c111d2.png" style="zoom:50%;" />

> 或门是计算机里面一种很特殊的门，它有两个输入，叫做A和B。如果A和B两个输入有一个是1，那么与门的输出就是1，否则输出就是0。或门的作用就像是一个开关，它能够根据两个输入的情况来决定是否让电流通过

**真值表和简化符号见下**

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/1fa1b3918342a0f28fc8dd09806512d5.png" style="zoom:50%;" />



#### 2.2.3 非门

**真值表和简化符号见下**

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/9d81d5ace39db5c41a25133770c46d57.png" style="zoom:50%;" />



#### 2.2.4 异或门

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/30ce5cef57526f44e2cbfaf1cc05da5d.png" style="zoom:50%;" />

> 异或门是一种特殊的非门，它可以把两个电信号进行比较，如果这两个信号相同，它的输出就是0;如果不同它的输出就是1。

**真值表和简化符号见下**

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/88ea86c818751922dadf00f4847d3bd6.png" style="zoom:50%;" />



### 2.3 加法器

#### 2.3.1 半加器

半加器，只能完成一半功能的加法器，这里说的一半功能就是他不能接收到进位

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/cd74563b312b5e87c62d4a632e6cf50a.png" style="zoom:50%;" />



#### 2.3.2 全加器

如果一个加法器能接收进位，还能完成加法，那他就是一个全加器

一个全加器由两个半加器组合而成。

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/6a91b3264b073c791dc228b78295d693.png)

**真值表**

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/1d5c0875a80b57b49a13203afc69ee3e.png" style="zoom:50%;" />



#### 2.3.3 8位二进制加法器

7个全加器+ 一个半加器，组成一个8位加法器

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/53b4f23eda7e249caa82b58eb64f2576.png)

#### 2.3.4 补充知识

##### 2.3.4.1 溢出

计算的结果超过了数据的容量时，就会出现数值溢出

> **溢出**是指某物超过了容器的容量而溢出。在生活中，我们可以看到很多溢出的例子。
>
> 当你在倒水时，如果你倒得太满了，水就会从杯子的边缘流出来。这就是一种溢出。
>
> **计算机溢出的概念**
> 内容:在有限的空间内，无法存储位数过大的数，则称为溢出。
> 说明:第8位的进位如果为1，则无法存储，此时容易引发错误，数据会归零，所以应该谨慎对待溢出



##### 2.3.4.2 有符号数和无符号数

**最高位表示符号**

> **有符号数是带符号的整数**，可以表示正数、负数和零。在计算机中，有符号数通常使用二进制补码表示，其中最高位表示符号位，0表示正数，1表示负数。
>
> 例如，8位有符号数可以表示从-128到127之间的整数其中最高位表示符号位。对于正数，最高位为0，其余位表示数值
>
> 例如，8位无符号数可以表示从0到255之间的整数，其中所有8位都用于表示数值
>
> 在使用有符号数和无符号数时，需要注意它们的区别，特别是在进行数学运算时。如果将有符号数和无符号数混合使用，可能会导致错误的结果



##### 2.3.4.3 负数的表示方法

**补码**

> **把一个正数的二进制按位取反，然后再加一就是负数的补码表示方法。**
>
> 使用补码表示法的优点在于，补码还可以避免在数值0上的两种表示方式 (+0和-0)，因此更加方便和精确。
>
> 有了补码的表示方法，计算机就可以用加法电路来完成减法运算

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/95b9fa3104bb43e9940ff531c01ce31d.png)

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/aebc94154ddae1c2ac524cfcbcbe160e.png)



### 2.4 ALU算术单元

**ALU:算术和逻辑运算单元**

> 我们可以把CPU的ALU抽象成一种符号
> 作用: ALU的抽象让工程师不再考虑细节层面的组成，简化工作。
>
> 图示内容包括
>
> - 输入A，B和opcode
> - 输出out
> - 标志flag: 溢出标记、零标记

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/7a721b6e542e61b02670b6eb1e8d3c90.png" style="zoom:50%;" />

## 3 存储电路

### 3.1 锁存器

与门可以存储下来0,或门可以存储下来1，我们把与门和或门进行一个组合，就能做出来第一个有用的电路结构。

> Din data in数据输入
> WE write enable
> 当WE为高电平的时候，Din的数据可以被存储起来
> 当WE为低电平的时候，out的值不发生变化

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/ef533de95a4d7f005781320e9dbd43b8.png)

### 3.2 寄存器

**寄存器=8位锁存器 /16 /32位**

> 一次可以存储8位数据。
> Din data in数据输入
> WE write enable
> 当WE为高电平的时候，Din的数据可以被存储起来
> 当WE为低电平的时候，out的值不发生变化

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/15149c9f5159111d0913ab8d13316307.png)

### 3.3 带边缘触发的锁存器

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/2c118522cc3aba9cafb9628b12213075.png)

**为什么需要时钟**

> 大家都见过划船的，划船需要一个喊口号的主要原因是为了保证协调。通过喊口号，船员们可以同步动作，确保船在平稳且有效率地前进。
>
> CPU需要clock来同步内部操作，如执行指令、进行数据传输等。Clock 提供了精确的时间控制，确保每个内部操作在正确的顺序与速度内执行，从而确保CPU的正常工作。另外，Clock 还与CPU 的频率相关，通过控制 Clock 频率，可以控制 CPU的速度

**时钟信号是什么**

> **时钟信号就是周期性的高低电平变化的信号**。我们可以用两个普通的寄存器加上一个非门，组成一个带有边缘触发的寄存器。在按钮按下的一瞬间，电压从低电平到高电平的一瞬间，Din的数据被存储起来。

### 3.4 寄存器的简化抽象符号

**存储器-寄存器**

> D:数据输入
> C>:时钟信号
> en:使能端口，高电平工作。
> Q:输出
>
> 可以做的扩展，增加输入使能WE和输出使能OE
> 寄存器访问速度快，因为寄存器的每一条数据线都是直接接出来的。

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/97ce6fc2f5d850430cb58a49e4a99524.png" style="zoom:67%;" />

### 3.5 内存单元

**内存地址: 从并行到串行**

> 内存单元格要自己自己在哪一行和哪一列，需要有row和column
> 内存单元要有ld (load) 读的控制
> 内存单元要有str (store) 存的控制
> 内存单元要有数据的输入

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/ba7cdb515eae163cff799cf21114c220.png)



### 3.6 画一个16位的内存

**行和列的位置就是内存地址**

> 我们采用二进制去描述行和列的位置，从而定位到特定的内存单元格，就可以完成内存的读写操作。
>
> 内存地址的作用主要是为了节省数据线，简化电路数量。有了内存地址的概念后，输入和输出只需要1条数据线了。
>
> 先选中需要读写的内存单元，再输入输出

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/1bf9161521c3d033df57186d8c88c7f9.png)

### 3.7 EPROM和FLASH

**EPROM和Flash都是可编程只读存储器(ProgrammableRead-Only Memory，PROM) 的类型它们都可以用于存储程序代码和其他类型的数据**

可编程可擦除只读存储器 (Erasable Programmable
Read Only Memory，EPROM) 是一种可写可读的存储
器。用户可根据需要来写入，并能把已写入的内容擦去后
再改写的ROM。这种存储器擦除原内容的方法很有特
点，可以使用点的方法，也可以采用紫外线照射的方法进
行擦除数据。

Flash可以通过电子方式进行擦除，这种擦除方式称为电子擦除 (Electrical Erase)通常使用高电压或者脉冲电压来擦除数据。

这两种存储掉电都会保存，现代单片机的存储代码很多是用flash来实现



## 4. 计算机系统核心组件

**要画出一个基本的计算机系统需要以下组件**

> **ALU (算术逻辑单元)** :  ALU是CPU的核心组件，负责执行所有算术和逻辑操作，如加、减、乘、除、与、或、非、异或等。
>
> **寄存器**: 寄存器是CPU中的存储器件，用于存储数据和指令。CPU需要许多寄存器来存储不同类型的数据和指令
>
> **内存**:内存是CPU中的另一个重要组件，它用于存储程序和数据。CPU需要一个内存管理单元来管理内存的读写操作。
>
> **时钟**: 时钟是CPU中的一个电子组件，它提供CPU的时序信号，确保所有操作都按照正确的时序执行。
>
> **控制单元**: 控制单元是CPU中的重要组件，它控制数据和指令在CPU内部的流动，并确保它们按照正确的顺序被执行。



### 4.1 CPU总线架构

![](https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/39465c6197273cad8981dcb17b6031f5.png)



### 4.2 机器语言和汇编语言

**机器语言**诸如下面的文字

```bin
0x0 0b00001110
0x1 0b00011111
0x2 0b00100000
0x3 0b00111111
```

上面的这段代码很难理解，计算机只认识0011，机器指令是二进制代码，直接由CPU执行，仅适合计算机读取和执行，难以理解和编写，要想看明白要对这个平台的计算机体系结构有深入的理解

**汇编语言**是对机器指令的文字版抽象，方便我们更容易的理解机器指令

汇编语言由操作码和操作数组成

```assembly
0000 LOAD_A
0001 LOAD_B
0010 ADD
0011 STORE
```

cpu指令集 汇编语言 LOADA，LOADB，ADD，STORE
详细作用描述见下图

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/216e16a92552a2be8447602bc6fc0076.png" alt="、" style="zoom:67%;" />



### 4.3 CPU执行程序的流程

**包含取指、解码和执行三个周期**

> **取指周期（Fetch）**
>
> 1. 把PC(程序位置计数器) 的值放入MAR(内存地址寄存器）
> 2. PC的值加1，指向下一条程序指令
> 3. 把MAR地址指向的内存中的数据取出来(操作码+操作数)放入MBR(内存缓存寄存器)
> 4. 把MBR中的数据放入IR (指令寄存器)
>
> **解码周期（Decode）**
>
> 1. decode操作码
>
> **执行周期（Execute）**
>
> 1. 根据操作码确定是LOAD A还是LOAD B还是add还是store指令
> 2. 不同的指令对应不同的操作

<img src="https://picgo-img-repo.oss-cn-beijing.aliyuncs.com/img/f3d2dbb564b10f153199cb4b91f00051.png" style="zoom:67%;" />